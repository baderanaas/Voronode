{# Reusable Jinja2 macros for common prompt patterns #}

{# Macro: Format tool list #}
{% macro tool_list() %}
Available Tools:
- CypherQueryTool: Query Neo4j graph database
- VectorSearchTool: Semantic search across documents
- CalculatorTool: Financial calculations (sum, avg, variance, percentiles)
- GraphExplorerTool: Explore relationships in graph
- ComplianceCheckTool: Validate against contract terms
- DateTimeTool: Get current date or calculate relative dates
- WebSearchTool: Search web for market rates, contractor info
- PythonREPLTool: Complex calculations and data analysis
- WorkflowTool: Manage document processing workflows
  * Actions: list_quarantined (find items awaiting review)
  * get_status|workflow_id=<id> (check workflow status)
  * resume|workflow_id=<id>|approved=true/false|notes=... (approve/reject quarantined items)
{% endmacro %}

{# Macro: JSON response instruction #}
{% macro json_response(schema) %}
Respond in JSON:
{{ schema }}
{% endmacro %}

{# Macro: Format step results #}
{% macro format_steps(steps) %}
{% for step in steps %}
Step {{ loop.index }}:
  Tool: {{ step.tool }}
  Action: {{ step.action }}
  {% if step.output %}Output: {{ step.output }}{% endif %}
  Status: {{ step.status }}
{% endfor %}
{% endmacro %}

{# Macro: Validation criteria #}
{% macro validation_criteria() %}
Validation Criteria:
1. **Completeness**: Did we execute all necessary steps from the plan?
2. **Correctness**: Are the results relevant to the user's query?
3. **Data Quality**: Do the results contain actual data (not empty)?
4. **Error Handling**: Were errors properly handled or escalated?
{% endmacro %}

{# Macro: Upload tool list #}
{% macro upload_tool_list() %}
Upload Tools (use only with upload_plan route):
- InvoiceUploadTool: Extract and store a PDF invoice
  * action: process|file_path=<path>
- ContractUploadTool: Extract and store a PDF contract
  * action: process|file_path=<path>
- BudgetUploadTool: Extract and store an Excel/CSV budget
  * action: process|file_path=<path>
{% endmacro %}

{# Macro: Execution modes explanation #}
{% macro execution_modes() %}
Execution Modes:
- **one_way**: For simple, straightforward queries
  - Single tool execution or independent parallel steps
  - All steps can be planned upfront
  - Examples: "show all invoices", "total retention"

- **react**: For complex, multi-step queries
  - Step N depends on result of step N-1
  - Discovery and exploration queries
  - Examples: "contractor with highest variance", "overdue invoices for projects over budget"
{% endmacro %}
